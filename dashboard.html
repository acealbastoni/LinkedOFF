<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… - LinkedOFF KSA</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/dashboard.css">
  <link rel="stylesheet" href="css/enhancements.css">

    <!-- â•â•â• EARLY AUTH GUARD â€” runs before any HTML renders â•â•â• -->
    <style>body { visibility: hidden; }</style>
    <script>
      (function () {
        try {
          var user = JSON.parse(localStorage.getItem('linkedoff_user') || 'null');
          var sess = JSON.parse(localStorage.getItem('linkedoff_session') || 'null');
          if (!user || !sess || !sess.token || Date.now() > Number(sess.expiresAtMs || 0)) {
            window.location.replace('login.html');
          } else {
            document.addEventListener('DOMContentLoaded', function () {
              document.body.style.visibility = 'visible';
            });
          }
        } catch (e) { window.location.replace('login.html'); }
      })();
    </script>
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

    <script src="js/auth.js"></script>
    <script>startSessionEnforcer();</script>
</head>
<body class="app-page" data-page="dashboard">
<div class="app-shell">
  <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar(false)"></div>
  <aside class="app-sidebar" id="appSidebar" aria-label="Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ©">
  <div class="sidebar-brand">
    <a href="search.html" class="brand-link">
      <span class="brand-mark">ğŸ’¼</span>
      <span class="brand-text">LinkedOFF</span>
      <span class="brand-sub">AceAlBastoni</span>
    </a>
  </div>

  <nav class="sidebar-nav">
    <a href="search.html"              class="nav-item"><span class="nav-ic">ğŸ </span><span>Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span></a>
    <a href="search.html"              class="nav-item"><span class="nav-ic">ğŸ”</span><span>Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„ÙˆØ¸Ø§Ø¦Ù</span></a>
    <a href="dashboard.html"           class="nav-item active"><span class="nav-ic">ğŸ“Š</span><span>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</span></a>
    <a href="analytics.html"           class="nav-item"><span class="nav-ic">ğŸ“ˆ</span><span>ØªØ­Ù„ÙŠÙ„Ø§Øª Ø§Ù„Ø³ÙˆÙ‚</span></a>
    <a href="saved.html"               class="nav-item"><span class="nav-ic">ğŸ’¾</span><span>Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©</span></a>
    <a href="history.html"             class="nav-item"><span class="nav-ic">ğŸ“¬</span><span>Ø³Ø¬Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„</span></a>
    <a href="engines-interactive.html" class="nav-item"><span class="nav-ic">âš™ï¸</span><span>Ø§Ù„Ù…Ø­Ø±ÙƒØ§Øª</span></a>
    <a href="about.html"               class="nav-item"><span class="nav-ic">ğŸ‘¤</span><span>Ø¹Ù† Ø§Ù„Ù…Ø·ÙˆÙ‘Ø±</span></a>
    <a href="pricing.html"             class="nav-item"><span class="nav-ic">ğŸ’³</span><span>Ø§Ù„Ø¨Ø§Ù‚Ø§Øª</span></a>
    <a href="settings.html"            class="nav-item"><span class="nav-ic">ğŸ”§</span><span>Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</span></a>
  </nav>

  <div class="sidebar-footer">
    <button class="sidebar-logout" type="button" onclick="performLogout('ğŸ‘‹ ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬', false)">
      <span class="nav-ic">ğŸšª</span><span>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</span>
    </button>
  </div>
</aside>
  <div class="app-main">
    <header class="app-topbar">
      <button class="sidebar-toggle" type="button" aria-label="ÙØªØ­/Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©" onclick="toggleSidebar()">
        <span class="toggle-bars"></span>
      </button>
      <div class="topbar-title">ğŸ“Š Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</div>
      <div class="topbar-actions">
        <button id="darkModeBtn" onclick="toggleDarkMode()" title="ÙˆØ¶Ø¹ Ù„ÙŠÙ„ÙŠ" style="
          background:none;border:1px solid #ddd;border-radius:8px;
          padding:6px 10px;cursor:pointer;font-size:18px;line-height:1;
          transition:background .2s,border-color .2s;
        ">ğŸŒ™</button>
      </div>
    </header>

    <main class="app-content">
<div class="dashboard-container">
        <div class="container">
            <!-- Welcome Section -->
            <div class="welcome-section">
                <h1>Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… ğŸ‘‹</h1>
                <p>Ø£Ù†Øª Ø§Ù„Ø¢Ù† Ù…Ø´ØªØ±Ùƒ ÙÙŠ Ø¨Ø§Ù‚Ø© <strong id="currentPlan">...</strong></p>
            </div>

            <!-- Stats Grid -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">ğŸ“Š</div>
                    <h3 id="jobsViewedCount">0</h3>
                    <p>ÙˆØ¸ÙŠÙØ© ØªÙ… Ù…Ø´Ø§Ù‡Ø¯ØªÙ‡Ø§</p>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ’¾</div>
                    <h3 id="savedJobsCount">0</h3>
                    <p>ÙˆØ¸ÙŠÙØ© Ù…Ø­ÙÙˆØ¸Ø©</p>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ“§</div>
                    <h3 id="appliedJobsCount">0</h3>
                    <p>ØªÙ‚Ø¯ÙŠÙ… Ù…Ø±Ø³Ù„</p>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ“±</div>
                    <h3 id="alertsCount">0</h3>
                    <p>ØªÙ†Ø¨ÙŠÙ‡ Ù†Ø´Ø·</p>
                </div>
            </div>

            <!-- Main Content -->
            <div class="dashboard-content">
                <!-- Saved Jobs Section -->
                <div class="dashboard-section">
                    <div class="section-header">
                        <h2>ğŸ’¾ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©</h2>
                        <button class="btn-outline" onclick="loadSavedJobs()">ØªØ­Ø¯ÙŠØ«</button>
                    </div>
                    <div id="savedJobsList" class="jobs-list">
                        <p class="empty-state">Ù„Ø§ ØªÙˆØ¬Ø¯ ÙˆØ¸Ø§Ø¦Ù Ù…Ø­ÙÙˆØ¸Ø© Ø­Ø§Ù„ÙŠØ§Ù‹</p>
                    </div>
                </div>

                <!-- Subscription Info -->
                <div class="dashboard-section">
                    <div class="section-header">
                        <h2>ğŸ“¦ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ</h2>
                        <button class="btn-primary" onclick="upgradeSubscription()">ØªØ±Ù‚ÙŠØ© Ø§Ù„Ø¨Ø§Ù‚Ø©</button>
                    </div>
                    <div class="subscription-info">
                        <div class="info-row">
                            <span>Ø§Ù„Ø¨Ø§Ù‚Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©:</span>
                            <strong id="planName">ØºÙŠØ± Ù…ÙØ¹Ù„</strong>
                        </div>
                        <div class="info-row">
                            <span>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ:</span>
                            <strong id="subscriptionDate">-</strong>
                        </div>
                        <div class="info-row">
                            <span>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ¬Ø¯ÙŠØ¯:</span>
                            <strong id="renewalDate">-</strong>
                        </div>
                        <div class="info-row">
                            <span>Ø§Ù„Ø­Ø§Ù„Ø©:</span>
                            <strong id="subscriptionStatus" class="status-active">Ù†Ø´Ø·</strong>
                        </div>
                    </div>
                </div>

                <!-- Job Alerts -->
                <div class="dashboard-section">
                    <div class="section-header">
                        <h2>ğŸ”” ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„ÙˆØ¸Ø§Ø¦Ù</h2>
                        <button class="btn-primary" onclick="createAlert()">Ø¥Ù†Ø´Ø§Ø¡ ØªÙ†Ø¨ÙŠÙ‡</button>
                    </div>
                    <div id="alertsList" class="alerts-list">
                        <div class="alert-card">
                            <div class="alert-info">
                                <h4>Ù…Ù‡Ù†Ø¯Ø³ Ø¨Ø±Ù…Ø¬ÙŠØ§Øª - Ø§Ù„Ø±ÙŠØ§Ø¶</h4>
                                <p>ØªÙ†Ø¨ÙŠÙ‡ Ù†Ø´Ø· â€¢ Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: Ø§Ù„ÙŠÙˆÙ…</p>
                            </div>
                            <div class="alert-actions">
                                <button class="btn-outline btn-sm" onclick="editAlert(1)">ØªØ¹Ø¯ÙŠÙ„</button>
                                <button class="btn-outline btn-sm" onclick="deleteAlert(1)">Ø­Ø°Ù</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Contact Support -->
                <div class="dashboard-section">
                    <div class="section-header">
                        <h2>ğŸ“ Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ</h2>
                    </div>
                    <div class="support-info">
                        <p>Ù‡Ù„ ØªØ­ØªØ§Ø¬ Ù…Ø³Ø§Ø¹Ø¯Ø©ØŸ ÙØ±ÙŠÙ‚Ù†Ø§ Ø¬Ø§Ù‡Ø² Ù„Ø®Ø¯Ù…ØªÙƒ</p>
                        <div class="support-buttons">
                            <a href="https://wa.me/966566114725" target="_blank" class="btn-primary">
                                ğŸ“± WhatsApp: 0566114725
                            </a>
                            <a href="tel:0566114725" class="btn-outline">
                                ğŸ“ Ø§ØªØµÙ„ Ø¨Ù†Ø§
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-bottom">
                <p id="copyrightText">&copy; 2024 LinkedOFF KSA. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.</p>
                <p class="footer-version" id="footerVersion">v1.2.0 - 25 Ø¯ÙŠØ³Ù…Ø¨Ø± 2024</p>
            </div>
        </div>
    </footer>

    <!-- Create Alert Modal -->
    <div class="modal" id="createAlertModal">
        <div class="modal-content">
            <span class="close" onclick="closeAlertModal()">&times;</span>
            <h2>ğŸ”” Ø¥Ù†Ø´Ø§Ø¡ ØªÙ†Ø¨ÙŠÙ‡ Ø¬Ø¯ÙŠØ¯</h2>
            <form onsubmit="saveAlert(event)">
                <div class="form-group">
                    <label>Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ÙØªØ§Ø­ÙŠØ©:</label>
                    <input type="text" id="alertKeywords" placeholder="Ù…Ø«Ø§Ù„: Ù…Ù‡Ù†Ø¯Ø³ Ø¨Ø±Ù…Ø¬ÙŠØ§ØªØŒ developer" required>
                </div>
                <div class="form-group">
                    <label>Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ):</label>
                    <select id="alertCity">
                        <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¯Ù†</option>
                        <option value="Ø§Ù„Ø±ÙŠØ§Ø¶">Ø§Ù„Ø±ÙŠØ§Ø¶</option>
                        <option value="Ø¬Ø¯Ø©">Ø¬Ø¯Ø©</option>
                        <option value="Ø§Ù„Ø¯Ù…Ø§Ù…">Ø§Ù„Ø¯Ù…Ø§Ù…</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>ØªÙ„Ù‚ÙŠ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø¹Ø¨Ø±:</label>
                    <div class="checkbox-group">
                        <label>
                            <input type="checkbox" checked> WhatsApp
                        </label>
                        <label>
                            <input type="checkbox" checked> Email
                        </label>
                    </div>
                </div>
                <button type="submit" class="btn-primary">Ø­ÙØ¸ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡</button>
            </form>
        </div>
    </div>

    <script src="js/config.js"></script>
    <script src="js/dashboard.js"></script>

    <!-- Version Badge -->
    </main>
  </div>
</div>

<script>
  // Highlight active sidebar link
  (function() {
    try {
      const current = (location.pathname.split('/').pop() || 'index.html').toLowerCase();
      document.querySelectorAll('.sidebar-nav .nav-item').forEach(a => {
        const href = (a.getAttribute('href') || '').toLowerCase();
        if (href === current) a.classList.add('active');
      });
    } catch(e) {}
  })();
</script>
<script>
  /* â”€â”€ Dark mode â”€â”€ */
  function initDarkMode() {
    if (localStorage.getItem('linkedoff_darkMode') === 'true') {
      document.body.classList.add('dark-mode');
      var btn = document.getElementById('darkModeBtn');
      if (btn) btn.textContent = 'â˜€ï¸';
    }
  }
  function toggleDarkMode() {
    var isDark = document.body.classList.toggle('dark-mode');
    localStorage.setItem('linkedoff_darkMode', isDark);
    var btn = document.getElementById('darkModeBtn');
    if (btn) btn.textContent = isDark ? 'â˜€ï¸' : 'ğŸŒ™';
  }
  document.addEventListener('DOMContentLoaded', initDarkMode);
</script>
<script>
  /* â”€â”€ Show user first name in topbar â”€â”€ */
  (function () {
    try {
      var user = JSON.parse(localStorage.getItem('linkedoff_user') || 'null');
      if (!user) return;
      var name = (user.name || user.email || '').split(' ')[0].split('@')[0];
      if (!name) return;
      var actions = document.querySelector('.topbar-actions');
      if (!actions) return;
      var chip = document.createElement('div');
      chip.id = 'topbarUserChip';
      chip.innerHTML = '<span class="avatar">ğŸ‘¤</span><span>' + name + '</span>';
      actions.insertBefore(chip, actions.firstChild);
    } catch (e) {}
  })();
</script>
    <script src="js/ui.js"></script>
</body>
</html>
